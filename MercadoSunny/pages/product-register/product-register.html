<!DOCTYPE html>
<html lang="en">

<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <link rel="stylesheet" href="../../css/default.css">
  <link rel="stylesheet" href="product-register.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../../js/default.js"></script>
  <script src="product-register.js"></script>
</head>

<header>
  <nav>
    <div class="topnav" id="myTopnav">
      <ul class="header-ul">
        <li class="header-li"><a id="icon-item" href="../home/home.html"><img id="icon"
              src="../../media/images/icon.png" alt="icon"></a></li>
        <li>
        <li class="topnav-right header-li">
          <a id="profile-item" href="../user-register/user-register.html"><img id="profile"
              src="../../media/images/profile.png" alt="profile"></a>
        </li>
        <li class="topnav-right header-li logged-text-container">
          <h4 id="logged-text">Usuário não autenticado</h4>
        </li>
        <li>
        </li>
      </ul>
  </nav>
  </div>
</header>

<body onload="authenticateUser()">
  <div id="register-div" class="col-lg-3 position-absolute top-50 start-50 translate-middle">
    <div class="container p-5 bg-light rounded">
      <h2>Cadastro de Produtos</h2>
      <form action=" /action_page.php">
        <div class="mb-3 mt-3">
          <label for="code">Código:</label>
          <input type="number" class="form-control" id="code" placeholder="Insira o código" name="code">
        </div>
        <div class="mb-3">
          <label for="name">Name:</label>
          <input type="text" class="form-control" id="name" placeholder="Insira o nome" name="name">
        </div>
        <div class="mb-3">
          <label for="quantity">Quantidade:</label>
          <input type="number" class="form-control" id="quantity" placeholder="Insira a quantidade" name="quantity">
        </div>
        <div class="mb-3">
          <label for="price">Preço:</label>
          <input type="number" class="form-control" id="price" placeholder="Insira o preço" name="price">
        </div>
        <button onClick="return saveProduct()" type="button" class="btn btn-primary">Salvar</button>
      </form>
    </div>
    <div id="register-buttons" class="container">
      <button onClick="return alternateToTable()" type="button" class="btn btn-primary form-control mt-3">Ver
        Tabela</button>
      <a class="btn btn-primary mt-3 form-control" id="icon-item" href="../report/report.html"
        target="_blank">Relatório</a>
    </div>
  </div>
  <div id="content">
    <div id="table-div" class="table-responsive d-none">
      <table class="table table-striped table-hover">
        <caption>Relatório de Produtos</caption>
        <thead class="thead-dark">
          <tr>
            <th scope="col">Código</th>
            <th scope="col">Nome</th>
            <th scope="col">Quantidade</th>
            <th scope="col">Preço</th>
            <th scope="col">Excluir</th>
            <th scope="col">Atualizar</th>
          </tr>
        </thead>
        <tbody id="productsBody">
          <script>
            var productsList = JSON.parse(localStorage.getItem("productsList"));

            function redirectToUpdatePage(code){
              let product =  productsList.filter(function(element) {
                return element.code === code;
              });
              localStorage.setItem("productUpdateRequest", JSON.stringify(product));
              window.location.replace("product-update-popup.html");
            }
            
            productsList.forEach((element) => {
              document.getElementById("productsBody").innerHTML +=
                `<tr>
                                <th scope="row">${element.code}</th>
                                <td>${element.name}</td>
                                <td>${element.quantity}</td>
                                <td>R$ ${element.price}</td>
                                <td><button onClick="return deleteProduct(${element.code})">⨉</button></td>
                                <td><button onClick="return redirectToUpdatePage(${element.code})">⨆</button></td>
                            </tr>`;
            });
          </script>
        </tbody>
      </table>
    </div>
  </div>
  <div id="table-buttons" class="container d-none">
    <button onClick="return alternateToRegister()" type="button" class="btn btn-primary form-control mt-3">Cadastrar
      Produto</button>
    <a class="btn btn-primary mt-3 form-control" id="icon-item" href="../report/report.html"
      target="_blank">Relatório</a>
  </div>
  <footer>
    Alunos: Gabriel Arno Voltolini, Lucas Mota de Oliveira e Victor do Amaral
  </footer>
</body>

</html>