<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../css/default.css">
    <link rel="stylesheet" href="product-register.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src='main.js'></script>
</head>
<body onload="fillUpdateForm()">
    <script>
        function fillUpdateForm(){
            var product = JSON.parse(localStorage.getItem('productUpdateRequest'))[0];
            document.getElementById('code').value = product.code;
            document.getElementById('name').value = product.name;
            document.getElementById('quantity').value = product.quantity;
            document.getElementById('price').value = product.price;
        }
        
        function returnToRegisterPage(){
             window.location.replace("product-register.html");
        }

        function saveProduct(){
            var product = {
                code: document.getElementById('code').value,
                name: document.getElementById('name').value,
                quantity: document.getElementById('quantity').value,
                price: document.getElementById('price').value
            };
            var products = JSON.parse(localStorage.getItem('productsList'));
            var index = products.map(object => object.code).indexOf(parseInt(product.code));
            products[index] = product;
            localStorage.setItem('productsList', JSON.stringify(products));
            returnToRegisterPage();
        }


    </script>

    <div id="register-div" class="col-lg-3 position-absolute top-50 start-50 translate-middle">
        <div class="container p-5 bg-light rounded">
          <h2>Atualizar produto</h2>
          <form action=" /action_page.php">
            <div class="mb-3 mt-3">
              <label for="code">Código:</label>
              <input type="number" class="form-control" id="code" placeholder="Insira o código" name="code">
            </div>
            <div class="mb-3">
              <label for="name">Name:</label>
              <input type="text" class="form-control" id="name" placeholder="Insira o nome" name="name">
            </div>
            <div class="mb-3">
              <label for="quantity">Quantidade:</label>
              <input type="number" class="form-control" id="quantity" placeholder="Insira a quantidade" name="quantity">
            </div>
            <div class="mb-3">
              <label for="price">Preço:</label>
              <input type="number" class="form-control" id="price" placeholder="Insira o preço" name="price">
            </div>
            <button onClick="return saveProduct()" type="button" class="btn btn-primary">Salvar</button>
            <button onClick="return returnToRegisterPage()" type="button" class="btn btn-primary">Cancelar</button>
          </form>
        </div>
</body>
</html>